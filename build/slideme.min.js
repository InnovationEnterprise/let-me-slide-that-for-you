var slideMe=slideMe||{},slideMeContainer,getHead=document.getElementsByTagName("head")[0],isMobile=navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/Android/i),thisVideoPlayer;slideMe.timeList=[],slideMe.errorThat=function(e,t){var i="Player error:<br>"+e;t.setAttribute("class","slideme-error"),t.innerHTML=i,slideMe=null},slideMe.addAttributes=function(e,t){for(var i in t)t.hasOwnProperty(i)&&e.setAttribute(i,t[i])},slideMe.throttle=function(e,t,i){var s,d;return function(){var l=i||this,a=+new Date,n=arguments;s&&s+t>a?(clearTimeout(d),d=setTimeout(function(){s=a,e.apply(l,n)},t)):(s=a,e.apply(l,n))}},slideMe.loadAssets=function(e,t,i){var s,d=document.getElementsByTagName("body")[0];"css"===t?(s=document.createElement("link"),s.href=e,s.rel="stylesheet",s.type="text/css"):(s=document.createElement("script"),s.src=e,s.async=!0,s.type="text/javascript"),d.appendChild(s),void 0!==i&&(s.onload=function(){i()})},slideMe.createDOM=function(){var e=document.createElement("div");if(e.setAttribute("id","slideme-wrapper"),void 0!==slideMe.data.videosourcesmobile||void 0!==slideMe.data.videosources){slideMe.thisVideoPlayer=document.createElement("video"),slideMe.addAttributes(slideMe.thisVideoPlayer,{id:"videojs",controls:""});var t;t=null!==isMobile?slideMe.data.videosourcesmobile:slideMe.data.videosources,slideMeContainer.appendChild(slideMe.thisVideoPlayer);for(var i in t)if(t.hasOwnProperty(i)){var s=document.createElement("source");slideMe.addAttributes(s,{src:t[i],type:i}),slideMe.thisVideoPlayer.appendChild(s)}if(void 0!==slideMe.data.subtitles)for(var d=0;d<slideMe.data.subtitles.length;d++){var l=document.createElement("track");slideMe.addAttributes(l,{src:slideMe.data.subtitles[d].src,srclang:slideMe.data.subtitles[d].srclang,label:slideMe.data.subtitles[d].label}),"true"===slideMe.data.subtitles[d]["default"]&&l.setAttribute("default",""),slideMe.thisVideoPlayer.appendChild(l)}slideMe.fireVideJs()}},slideMe.loadJson=function(e){var t=new XMLHttpRequest;t.open("GET",e,!0),t.onload=function(){t.status>=200&&t.status<400?(slideMe.data=JSON.parse(t.responseText),(void 0!==slideMe.data.videosourcesmobile||void 0!==slideMe.data.videosources)&&slideMe.loadAssets("//vjs.zencdn.net/4.11.2/video.js","script",function(){slideMe.createDOM()}),void 0!==slideMe.data.videoslides&&slideMe.getSlides(),console.log("json fetched")):slideMe.errorThat("cannot connect",slideMeContainer)},t.onerror=function(){slideMe.errorThat("cannot connect",slideMeContainer)},t.send()},slideMe.reload=function(e){for(videojs.dispose();slideMeContainer.firstChild;)slideMeContainer.removeChild(slideMeContainer.firstChild);addPreloader(),loadJson(e)};var insertSpiner=document.createElement("style");insertSpiner.innerHTML='[data-slidemejs] {font-family: Helvetica, Arial, sans-serif;}#slideme-preloader{position:absolute;top:0;bottom:0;left:0;right:0;padding:15% 0 0;background:#fff;z-index:100;color:#000;text-align:center}#slideme-preloader:after{content:"Loading, please wait...";font-size:12px;font-weight:100;display:block}@keyframes slideMeSpinner{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}@-webkit-keyframes slideMeSpinner{from{-webkit-transform:rotate(0deg)}to{-webkit-transform:rotate(360deg)}}.icon-spinner{-webkit-animation:slideMeSpinner .75s linear infinite;animation:slideMeSpinner 2s linear infinite;font-size:20px;line-height:50px;width:50px;height:50px;cursor:default;text-align:center;color:#000}',getHead.appendChild(insertSpiner),slideMe.addPreloader=function(){var e='<i class="icon-spinner">.</i>';preloaderWrapper=document.createElement("div"),preloaderWrapper.setAttribute("id","slideme-preloader"),preloaderWrapper.innerHTML=e,slideMeContainer.appendChild(preloaderWrapper),preloaderWrapper.remove()},slideMe.playList=function(){function e(){return slideMe.reload(this.getAttribute("data-json")),!1}var t;null!==document.getElementById("slideme-playlist")?t=document.getElementById("slideme-playlist"):(t=document.createElement("div"),t.setAttribute("id","slideme-playlist")),t.innerHTML='<div id="slideme-playlist-title">Playlist<div id="slideme-playlist-drop">></div></div><div id="slideme-playlist-list"></div>',slideMeContainer.appendChild(t),slideMeContainer.style.margin="0 auto 50px auto";var i=document.getElementById("slideme-playlist-title"),s=document.getElementById("slideme-playlist-list");void 0!==data.playlist&&(playListData=data.playlist);for(var d=0;d<playListData.length;d++){var l;"json"===playListData[d].type?(l=document.createElement("p"),l.innerHTML=playListData[d].title,l.setAttribute("data-json",playListData[d].link),s.appendChild(l),l.addEventListener("click",e)):(l=document.createElement("a"),l.innerHTML=playListData[d].title,l.setAttribute("href",playListData[d].link),s.appendChild(l))}var a=!1;i.addEventListener("click",function(){a===!1?(a=!0,s.style.display="block",i.classList.add("slideme-drop-active")):(a=!1,s.style.display="none",i.classList.remove("slideme-drop-active"))})},slideMe.destroyPlaylist=function(){document.getElementById("slideme-playlist").remove()},slideMe.fireVideJs=function(){if(void 0===slideMe.data.preload&&(slideMe.data.preload="metadata"),void 0===slideMe.data.poster&&(slideMe.data.poster=""),slideMe.addAttributes(slideMe.thisVideoPlayer,{"class":"video-js vjs-default-skin",poster:slideMe.data.poster,preload:slideMe.data.preload}),thisPlayer=videojs(slideMe.thisVideoPlayer),void 0!==slideMe.data.adTagUrl){var e={id:"videojs",adTagUrl:slideMe.data.adTagUrl};slideMe.loadAssets("../build/slidemeads.css","css"),slideMe.loadAssets("//imasdk.googleapis.com/js/sdkloader/ima3.js","script",function(){slideMe.loadAssets("../build/slidemeads.js","script",function(){thisPlayer.ima(e),thisPlayer.ima.initializeAdDisplayContainer(),thisPlayer.ima.requestAds(),console.log("ad script loaded")})})}thisPlayer.ready(function(){slideMe.thisPlayer=this,slideMe.setSize(),window.onresize=slideMe.throttle(slideMe.setSize,200),console.log("player created"),"html"===slideMe.data.videoslidestype&&(preloaderWrapper.remove(),slideMeContainer.style.overflow="visible"),void 0!==slideMe.data.autoplay&&"false"!==slideMe.data.autoplay&&thisPlayer.play()})},slideMe.getSlides=function(){slideMe.presentationNode=document.createElement("div"),slideMe.presentationNode.setAttribute("id","slideme-container"),slideMeContainer.appendChild(slideMe.presentationNode),slideMe.createImgContainer=document.createElement("div"),slideMe.createImgContainer.setAttribute("id","slideme-list");var e=document.createElement("div");if(e.setAttribute("id","slideme-list-wrapper"),slideMeContainer.appendChild(e),"images"===slideMe.data.videoslidestype){var t='<div id="slideme-btn-prev"><i class="icon-prevslide"><</i></div><div id="slideme-btn-next"><i class="icon-nextslide">></i></div>';e.innerHTML=t,void 0!==slideMe.data.videosourcesmobile||void 0!==slideMe.data.videosources?slideMeContainer.setAttribute("class","slideme-images"):slideMeContainer.setAttribute("class","slideme-images-only"),slideMe.loadImages()}else{e.setAttribute("class","slideme-text");var i=document.createElement("div");i.setAttribute("id","slideme-html-nav"),i.innerHTML='<div id="slideme-html-nav-left"><</div><div id="slideme-html-nav-right">></div>',e.appendChild(i),slideMeContainer.setAttribute("class","slideme-html")}e.appendChild(slideMe.createImgContainer)},slideMe.setNewSlide=function(e){for(var t,i="00",s=Math.round(thisPlayer.currentTime()),d=0;d<slideMe.timeList.length;d++)s>=slideMe.timeList[d]&&(t=slideMe.timeList[d]);if(i!==t){i=t;var l=document.querySelectorAll('[data-slideme-time="'+t+'"]')[0];"images"===slideMe.data.videoslidestype?(slideMe.createImgContainer.style.left=l!==slideMe.addClicks[0]?150-l.offsetLeft+"px":50-l.offsetLeft+"px",e.setAttribute("src",l.getAttribute("src"))):slideMe.createImgContainer.style.top=-l.offsetTop+"px",document.getElementsByClassName("slideme-img-active")[0].classList.remove("slideme-img-active"),l.setAttribute("class","slideme-img-active")}},slideMe.setSize=function(){var e,t,i=slideMeContainer.parentNode.offsetWidth,s=i;void 0===slideMe.data.videosourcesmobile&&void 0===slideMe.data.videosources?e=480:(i/=2,e=i/1.78,s=i,t=e,i=1.33*e),void 0===slideMe.data.videoslides?t=s/1.78:(slideMe.presentationNode.style.width=i+"px",slideMe.presentationNode.style.height=e+"px",slideMeContainer.style.height=t+75+"px"),slideMe.thisPlayer.dimensions(s,t),slideMeContainer.style.width=s+i+"px"},slideMe.loadImages=function(){for(var e=0,t=slideMe.data.videoslides.length,i=0;t>i;i++)!function(){var s=slideMe.data.videoslides[i].slidecontent,d=new Image;d.src=s,d.onload=function(){e+=1,e===t&&slideMe.setContent(!0)},d.onerror=function(){errorThat("cannot load image",slideMeContainer)}}()},slideMe.sliderClickEvent=function(e,t){function i(){if(t===!0){var i=thisPlayer.duration();if(slideMe.data.videosourcesmobile&&i>10||slideMe.data.videosources&&i>10){var s=this.getAttribute("data-slideme-time");thisPlayer.currentTime(s),thisPlayer.play()}}"images"===slideMe.data.videoslidestype&&this!==slideMe.addClicks[0]&&(slideMe.createImgContainer.style.left=150-this.offsetLeft+"px"),"images"===slideMe.data.videoslidestype&&e.setAttribute("src",this.getAttribute("src")),document.getElementsByClassName("slideme-img-active")[0].classList.remove("slideme-img-active"),this.setAttribute("class","slideme-img-active")}slideMe.addClicks=document.querySelectorAll("[data-slideme-time]"),slideMe.addClicks[0].setAttribute("class","slideme-img-active");for(var s=0;s<slideMe.addClicks.length;s++)slideMe.addClicks[s].addEventListener("click",i,!1)},slideMe.setContent=function(e){for(var t,i=slideMe.data.videoslides,s=0;s<i.length;s++){var d,l=i[s].slidecontent,a=60*i[s].timemin+parseInt(i[s].timesec);e?(d=document.createElement("img"),slideMe.addAttributes(d,{src:l,"data-slideme-time":a}),imgContainerWidth=100*i.length,slideMe.createImgContainer.style.width=imgContainerWidth+"px"):(d=document.createElement("div"),d.innerHTML='<div class="slideme-list-content">'+l+"</div>",d.setAttribute("data-slideme-time",a)),slideMe.timeList.push(a),slideMe.createImgContainer.appendChild(d)}if(e){var n=i[0].slidecontent;t=document.createElement("img"),t.setAttribute("src",n),slideMe.presentationNode.appendChild(t),preloaderWrapper.remove(),slideMeContainer.style.overflow="visible"}if(console.log("slider content set"),"html"===slideMe.data.videoslidestype){var r=!0;document.getElementById("slideme-html-nav-left").addEventListener("click",function(){var e=slideMe.createImgContainer.offsetTop;0>e&&r===!0&&(slideMe.createImgContainer.style.top=slideMe.createImgContainer.offsetTop+360+"px",r=!1,setTimeout(function(){r=!0},350))}),document.getElementById("slideme-html-nav-right").addEventListener("click",function(){var e=slideMe.createImgContainer.offsetTop,t=slideMe.createImgContainer.offsetHeight;e>-t+360&&r===!0&&(slideMe.createImgContainer.style.top=slideMe.createImgContainer.offsetTop-360+"px",r=!1,setTimeout(function(){r=!0},350))})}slideMe.data.videosourcesmobile||slideMe.data.videosources?thisPlayer.ready(function(){slideMe.sliderClickEvent(t,!0),slideMe.setNewSlide(t)}):slideMe.sliderClickEvent(t,!1)},document.addEventListener("DOMContentLoaded",function(){slideMeContainer=document.querySelectorAll("[data-slidemejs]")[0],slideMe.addPreloader(),void 0!==slideMeContainer&&""!==slideMeContainer.getAttribute("data-slidemejs")&&slideMe.loadJson(slideMeContainer.getAttribute("data-slidemejs")),slideMe.loadAssets("../build/slidemecss.min.css","css")});