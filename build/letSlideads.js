(function(c,z,n,u){var v=function(b){var a,e,d;for(e=1;e<arguments.length;e++)for(d in a=arguments[e],a)a.hasOwnProperty(d)&&(b[d]=a[d]);return b},w=function(b,a,e){var d=Object.prototype.toString.call(a),f=function(a,b,d){if(a.addEventListener)a.addEventListener(b,d);else if(a.on)a.on(b,d);else if(a.attachEvent)a.attachEvent("on"+b,d);else throw Error("object has no mechanism for adding event listeners");},c;switch(d){case "[object String]":f(b,a,e);break;case "[object Array]":c=0;for(d=a.length;c<
d;c++)f(b,a[c],e);break;case "[object Object]":for(c in a)a.hasOwnProperty(c)&&f(b,c,a[c]);break;default:throw Error("Unrecognized events parameter type: "+d);}return b},h=function(b){return(c.setImmediate||c.requestAnimationFrame||c.mozRequestAnimationFrame||c.webkitRequestAnimationFrame||c.setTimeout)(b,0)},q=function(b){return(c.clearImmediate||c.cancelAnimationFrame||c.webkitCancelAnimationFrame||c.mozCancelAnimationFrame||c.clearTimeout)(b)},k=function(b){b.ads.cancelPlayTimeout||(b.ads.cancelPlayTimeout=
h(function(){b.ads.cancelPlayTimeout=null;b.paused()||b.pause();b.one("contentplayback",function(){b.paused()&&b.play()})}))},r=function(b){var a=b.el().querySelector(".vjs-tech"),c=b.remoteTextTracks?b.remoteTextTracks():[],d,f=[];b={ended:b.ended(),src:b.currentSrc(),currentTime:b.currentTime(),type:b.currentType()};a&&(b.nativePoster=a.poster,b.style=a.getAttribute("style"));for(d=c.length;d--;)a=c[d],f.push({track:a,mode:a.mode}),a.mode="disabled";b.suppressedTracks=f;return b},l=function(b,a){for(var c=
b.className.split(/\s+/),d=c.length,f=[];d--;)c[d]!==a&&f.push(c[d]);b.className=f.join(" ")},x=function(b,a){var e=b.el().querySelector(".vjs-tech"),d=20,f=a.suppressedTracks,m,g=function(){for(var a=f.length;a--;)m=f[a],m.track.mode=m.mode},h=function(){var d=!1,f=function(){d=!0};b.currentTime(a.currentTime);a.ended?(c.setTimeout(function(){d||b.play();b.off("ended",f)},250),b.on("ended",f)):b.play()},p=function(){if(1<e.readyState||e.seekable===u||0<e.seekable.length)return h();if(d--)setTimeout(p,
50);else try{h()}catch(a){videojs.log.warn("Failed to resume the content after an advertisement",a)}};a.nativePoster&&(e.poster=a.nativePoster);"style"in a&&e.setAttribute("style",a.style||"");(b.src()?b.src()!==a.src:b.currentSrc()!==a.src)?(b.one("contentloadedmetadata",g),b.src({src:a.src,type:a.type}),b.load(),b.one("contentcanplay",p)):b.ended()&&a.ended||(g(),b.play())},t=function(b){(b=b.el().querySelector(".vjs-tech"))&&b.removeAttribute("poster")},y={timeout:5E3,prerollTimeout:100,postrollTimeout:100,
debug:!1};n.plugin("ads",function(b){var a=this,e=v({},y,b||{});(function(){var b=videojs.Html5.Events,c,e=function(){return!0},g=function(b,c){c.isImmediatePropagationStopped=e;c.cancelBubble=!0;c.isPropagationStopped=e;a.trigger({type:b+c.type,state:a.ads.state,originalEvent:c})},h=function(b){if("ad-playback"===a.ads.state)g("ad",b);else if("content-playback"===a.ads.state&&"ended"===b.type)g("content",b);else if("content-resuming"===a.ads.state){if(a.ads.snapshot){if(a.currentSrc()!==a.ads.snapshot.src)return"loadstart"===
b.type?void 0:g("content",b);if(a.ads.snapshot.ended){if("pause"===b.type||"ended"===b.type){a.addClass("vjs-has-started");return}return g("content",b)}}"playing"!==b.type&&g("content",b)}};b.push("firstplay");b.push("loadedalldata");for(c=b.length;c--;)a.on(b[c],h);return h})();a.on(["addurationchange","adcanplay"],function(){var b=a.ads.snapshot;a.currentSrc()!==b.src&&a.play()});a.ads={state:"content-set",startLinearAdMode:function(){"ad-playback"!==a.ads.state&&a.trigger("adstart")},endLinearAdMode:function(){"ad-playback"===
a.ads.state&&a.trigger("adend")},skipLinearAdMode:function(){"ad-playback"!==a.ads.state&&a.trigger("adskip")}};b=function(b){var f={"content-set":{events:{adscanceled:function(){this.state="content-playback"},adsready:function(){this.state="ads-ready"},play:function(){this.state="ads-ready?";k(a);t(a)},adserror:function(){this.state="content-playback"},adskip:function(){this.state="content-playback"}}},"ads-ready":{events:{play:function(){this.state="preroll?";k(a)},adskip:function(){this.state=
"content-playback"},adserror:function(){this.state="content-playback"}}},"preroll?":{enter:function(){a.el().className+=" vjs-ad-loading";a.ads.timeout=c.setTimeout(function(){a.trigger("adtimeout")},e.prerollTimeout);a.trigger("readyforpreroll")},leave:function(){c.clearTimeout(a.ads.timeout);l(a.el(),"vjs-ad-loading")},events:{play:function(){k(a)},adstart:function(){this.state="ad-playback"},adskip:function(){this.state="content-playback"},adtimeout:function(){this.state="content-playback"},adserror:function(){this.state=
"content-playback"}}},"ads-ready?":{enter:function(){a.el().className+=" vjs-ad-loading";a.ads.timeout=c.setTimeout(function(){a.trigger("adtimeout")},e.timeout)},leave:function(){c.clearTimeout(a.ads.timeout);l(a.el(),"vjs-ad-loading")},events:{play:function(){k(a)},adscanceled:function(){this.state="content-playback"},adsready:function(){this.state="preroll?"},adskip:function(){this.state="content-playback"},adtimeout:function(){this.state="content-playback"},adserror:function(){this.state="content-playback"}}},
"ad-playback":{enter:function(){this.snapshot=r(a);a.el().className+=" vjs-ad-playing";t(a);a.ads.cancelPlayTimeout&&(q(a.ads.cancelPlayTimeout),a.ads.cancelPlayTimeout=null)},leave:function(){l(a.el(),"vjs-ad-playing");x(a,this.snapshot);"adend"!==a.ads.triggerevent&&a.trigger("adend")},events:{adend:function(){this.state="content-resuming"},adserror:function(){this.state="content-resuming"}}},"content-resuming":{enter:function(){this.snapshot.ended&&(c.clearTimeout(a.ads._fireEndedTimeout),a.ads._fireEndedTimeout=
c.setTimeout(function(){a.trigger("ended")},1E3))},leave:function(){c.clearTimeout(a.ads._fireEndedTimeout)},events:{contentupdate:function(){this.state="content-set"},playing:function(){this.state="content-playback"},ended:function(){this.state="content-playback"}}},"postroll?":{enter:function(){this.snapshot=r(a);a.el().className+=" vjs-ad-loading";a.ads.timeout=c.setTimeout(function(){a.trigger("adtimeout")},e.postrollTimeout)},leave:function(){c.clearTimeout(a.ads.timeout);l(a.el(),"vjs-ad-loading")},
events:{adstart:function(){this.state="ad-playback"},adskip:function(){this.state="content-resuming";h(function(){a.trigger("ended")})},adtimeout:function(){this.state="content-resuming";h(function(){a.trigger("ended")})},adserror:function(){this.state="content-resuming";h(function(){a.trigger("ended")})}}},"content-playback":{enter:function(){a.ads.cancelPlayTimeout&&(q(a.ads.cancelPlayTimeout),a.ads.cancelPlayTimeout=null);a.trigger({type:"contentplayback",triggerevent:a.ads.triggerevent})},events:{adsready:function(){a.trigger("readyforpreroll")},
adstart:function(){this.state="ad-playback"},contentupdate:function(){a.paused()?this.state="content-set":this.state="ads-ready?"},contentended:function(){this.state="postroll?"}}}};(function(c){var g=function(){};((f[c].events||{})[b.type]||g).apply(a.ads);c!==a.ads.state&&(a.ads.triggerevent=b.type,(f[c].leave||g).apply(a.ads),(f[a.ads.state].enter||g).apply(a.ads),e.debug&&videojs.log("ads",a.ads.triggerevent+" triggered: "+c+" -> "+a.ads.state))})(a.ads.state)};w(a,n.Html5.Events.concat("adtimeout contentupdate contentplaying contentended adsready adserror adscanceled adstart adend adskip".split(" ")),
b);a.ads.contentSrc=a.currentSrc();(function(){var b=function(){var b;"ad-playback"!==a.ads.state&&(b=a.currentSrc(),b!==a.ads.contentSrc&&(a.trigger({type:"contentupdate",oldValue:a.ads.contentSrc,newValue:b}),a.ads.contentSrc=b))};a.on(["loadstart"],b);h(b)})();a.paused()||b({type:"play"})})})(window,document,videojs);
(function(H){var M=function(z){var q,a,d;for(a=1;a<arguments.length;a++)for(d in q=arguments[a],q)q.hasOwnProperty(d)&&(z[d]=q[d]);return z},U={debug:!1,timeout:5E3,prerollTimeout:100};H.plugin("ima",function(z,q){var a=this;a.ima.createAdContainer_=function(){t=a.getChild("controlBar");f=t.el().parentNode.insertBefore(document.createElement("div"),t.el());f.id="ima-ad-container";f.style.width=a.width()+"px";f.style.height=a.height()+"px";f.addEventListener("mouseover",a.ima.showAdControls_,!1);f.addEventListener("mouseout",
a.ima.hideAdControls_,!1);a.ima.createControls_();D=new google.ima.AdDisplayContainer(f,N)};a.ima.createControls_=function(){e=document.createElement("div");e.id="ima-controls-div";e.style.width="100%";r=document.createElement("div");r.id="ima-countdown-div";r.innerHTML="Advertisement";r.style.display=A?"block":"none";u=document.createElement("div");u.id="ima-seek-bar-div";u.style.width=a.width()+"px";E=document.createElement("div");E.id="ima-progress-div";h=document.createElement("div");h.id="ima-play-pause-div";
h.className="ima-playing";h.addEventListener("click",a.ima.onAdPlayPauseClick_,!1);k=document.createElement("div");k.id="ima-mute-div";k.className="ima-non-muted";k.addEventListener("click",a.ima.onAdMuteClick_,!1);l=document.createElement("div");l.id="ima-slider-div";l.addEventListener("mousedown",a.ima.onAdVolumeSliderMouseDown_,!1);v=document.createElement("div");v.id="ima-slider-level-div";n=document.createElement("div");n.id="ima-fullscreen-div";n.className="ima-non-fullscreen";n.addEventListener("click",
a.ima.onAdFullscreenClick_,!1);f.insertBefore(e,f.childNodes[f.childNodes.length]);e.insertBefore(r,e.childNodes[e.childNodes.length]);e.insertBefore(u,e.childNodes[e.childNodes.length]);e.insertBefore(h,e.childNodes[e.childNodes.length]);e.insertBefore(k,e.childNodes[e.childNodes.length]);e.insertBefore(l,e.childNodes[e.childNodes.length]);e.insertBefore(n,e.childNodes[e.childNodes.length]);u.insertBefore(E,u.childNodes[e.childNodes.length]);l.insertBefore(v,l.childNodes[l.childNodes.length])};a.ima.initializeAdDisplayContainer=
function(){O=!0;D.initialize()};a.ima.requestAds=function(){O||D.initialize();var b=new google.ima.AdsRequest;b.adTagUrl=d.adTagUrl;b.linearAdSlotWidth=a.width();b.linearAdSlotHeight=a.height();b.nonLinearAdSlotWidth=d.nonLinearWidth||a.width();b.nonLinearAdSlotHeight=d.nonLinearHeight||a.height()/3;g.requestAds(b)};a.ima.onAdsManagerLoaded_=function(b){c=b.getAdsManager(w,F);c.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,a.ima.onAdError_);c.addEventListener(google.ima.AdEvent.Type.AD_BREAK_READY,
a.ima.onAdBreakReady_);c.addEventListener(google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,a.ima.onContentPauseRequested_);c.addEventListener(google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,a.ima.onContentResumeRequested_);c.addEventListener(google.ima.AdEvent.Type.ALL_ADS_COMPLETED,a.ima.onAllAdsCompleted_);c.addEventListener(google.ima.AdEvent.Type.LOADED,a.ima.onAdLoaded_);c.addEventListener(google.ima.AdEvent.Type.STARTED,a.ima.onAdStarted_);c.addEventListener(google.ima.AdEvent.Type.CLICK,a.ima.onAdPlayPauseClick_);
c.addEventListener(google.ima.AdEvent.Type.COMPLETE,a.ima.onAdComplete_);c.addEventListener(google.ima.AdEvent.Type.SKIPPED,a.ima.onAdComplete_);if(!x)try{c.init(a.width(),a.height(),google.ima.ViewMode.NORMAL),c.setVolume(a.muted()?0:a.volume())}catch(d){a.ima.onAdError_(d)}a.trigger("adsready")};a.ima.start=function(){if(x)try{c.init(a.width(),a.height(),google.ima.ViewMode.NORMAL),c.setVolume(a.muted()?0:a.volume()),c.start()}catch(b){a.ima.onAdError_(b)}};a.ima.onAdsLoaderError_=function(b){window.console.log("AdsLoader error: "+
b.getError());c&&c.destroy();a.trigger("adserror")};a.ima.onAdError_=function(b){window.console.log("Ad error: "+b.getError());t.show();c.destroy();f.style.display="none";a.trigger("adserror")};a.ima.onAdBreakReady_=function(a){P(a)};a.ima.playAdBreak=function(){x||c.start()};a.ima.onContentPauseRequested_=function(b){p=G=!0;a.off("ended",I);-1!=b.getAd().getAdPodInfo().getPodIndex()&&a.ads.startLinearAdMode();f.style.display="block";e.style.display="block";t.hide();a.pause()};a.ima.onContentResumeRequested_=
function(b){p=G=!1;a.on("ended",I);m&&m.isLinear()&&(f.style.display="none");t.show();m?y||-1==m.getAdPodInfo().getPodIndex()||a.ads.endLinearAdMode():a.ads.endLinearAdMode();r.innerHTML=""};a.ima.onAllAdsCompleted_=function(a){J=!0;if(1==y)for(var c in B)B[c]()};a.ima.onAdLoaded_=function(b){b.getAd().isLinear()||a.play()};a.ima.onAdStarted_=function(b){m=b.getAd();m.isLinear()?(Q=setInterval(a.ima.onAdPlayheadTrackerInterval_,250),f.className=""):f.className="bumpable-ima-ad-container"};a.ima.onAdComplete_=
function(a){m.isLinear()&&clearInterval(Q)};a.ima.onAdPlayheadTrackerInterval_=function(){var a=c.getRemainingTime(),d=m.getDuration(),e=d-a,e=0<e?e:0,f=!1,g,h;m.getAdPodInfo()&&(f=!0,g=m.getAdPodInfo().getAdPosition(),h=m.getAdPodInfo().getTotalAds());var k=Math.floor(a/60),a=Math.floor(a%60);2>a.toString().length&&(a="0"+a);var l=": ";f&&(l=" ("+g+" of "+h+"): ");r.innerHTML="Advertisement"+l+k+":"+a;E.style.width=e/d*100+"%"};a.ima.hideAdControls_=function(){h.style.display="none";k.style.display=
"none";n.style.display="none";e.style.height="14px"};a.ima.showAdControls_=function(){e.style.height="37px";h.style.display="block";k.style.display="block";l.style.display="block";n.style.display="block"};a.ima.onAdPlayPauseClick_=function(){p?(h.className="ima-paused",c.pause(),p=!1):(h.className="ima-playing",c.resume(),p=!0)};a.ima.onAdMuteClick_=function(){C?(k.className="ima-non-muted",c.setVolume(1),a.muted(!1),C=!1,v.style.width=100*a.volume()+"%"):(k.className="ima-muted",c.setVolume(0),a.muted(!0),
C=!0,v.style.width="0%")};a.ima.onAdVolumeSliderMouseDown_=function(){document.addEventListener("mouseup",a.ima.onMouseUp_,!1);document.addEventListener("mousemove",a.ima.onMouseMove_,!1)};a.ima.onMouseMove_=function(b){a.ima.setVolumeSlider_(b)};a.ima.onMouseUp_=function(b){a.ima.setVolumeSlider_(b);document.removeEventListener("mousemove",a.ima.onMouseMove_);document.removeEventListener("mouseup",a.ima.onMouseUp_)};a.ima.setVolumeSlider_=function(b){b=(b.clientX-l.getBoundingClientRect().left)/
l.offsetWidth;b=Math.min(Math.max(100*b,0),100);v.style.width=b+"%";a.volume(b/100);c.setVolume(b/100);0==a.volume()?(k.className="ima-muted",a.muted(!0),C=!0):(k.className="ima-non-muted",a.muted(!1),C=!1)};a.ima.onAdFullscreenClick_=function(){a.isFullscreen()?a.exitFullscreen():a.requestFullscreen()};a.ima.onFullscreenChange_=function(){a.isFullscreen()?(n.className="ima-fullscreen",f.style.width=window.screen.width+"px",f.style.height=window.screen.height+"px",c.resize(window.screen.width,window.screen.height,
google.ima.ViewMode.FULLSCREEN)):(n.className="ima-non-fullscreen",f.style.width=a.width()+"px",f.style.height=a.height()+"px",c.resize(a.width(),a.height(),google.ima.ViewMode.NORMAL))};a.ima.onVolumeChange_=function(){var b=a.muted()?0:a.volume();c&&c.setVolume(b)};a.ima.seekContentToZero_=function(){a.off("loadedmetadata",a.ima.seekContentToZero_);a.currentTime(0)};a.ima.playContentFromZero_=function(){a.off("loadedmetadata",a.ima.playContentFromZero_);a.currentTime(0);a.play()};a.ima.resetIMA_=
function(){c&&(c.destroy(),c=null);g&&!y&&g.contentComplete();J=y=!1};a.ima.addEventListener=function(a,d){c&&c.addEventListener(a,d)};a.ima.getAdsManager=function(){return c};a.ima.setContent=function(b,c,e){a.ima.resetIMA_();d.adTagUrl=c?c:d.adTagUrl;a.currentSrc()&&a.pause();b&&a.src(b);if(e)a.on("loadedmetadata",a.ima.playContentFromZero_);else a.on("loadedmetadata",a.ima.seekContentToZero_)};a.ima.addContentEndedListener=function(a){K.push(a)};a.ima.addContentAndAdsEndedListener=function(a){B.push(a)};
a.ima.setAdBreakReadyListener=function(a){P=a};a.ima.pauseAd=function(){G&&p&&(h.className="ima-paused",c.pause(),p=!1)};a.ima.resumeAd=function(){G&&!p&&(h.className="ima-playing",c.resume(),p=!0)};a.ima.setUpPlayerIntervals_=function(){R=setInterval(a.ima.updateCurrentTime,L);S=setInterval(a.ima.checkForSeeking_,L)};a.ima.updateCurrentTime=function(){w.seeking||(w.currentTime=a.currentTime())};a.ima.checkForSeeking_=function(){var b=1E3*(a.currentTime()-w.previousTime);w.seeking=Math.abs(b)>L+H?
!0:!1;w.previousTime=a.currentTime()};a.ima.setShowCountdown=function(a){A=a;r.style.display=A?"block":"none"};var d,N,A,x,t,f,e,r,u,E,h,k,l,v,n,D,O=!1,g,c,F=null,m,Q,G=!1,p=!1,C=!1,y=!1,J=!1,R,S,L=1E3,H=100,w={currentTime:0,previousTime:0,seeking:!1,duration:0},K=[],B=[],P=void 0,I=function(){g&&!y&&(g.contentComplete(),y=!0);for(var b in K)K[b]();if(J)for(b in B)B[b]();clearInterval(R);clearInterval(S);a.one("play",a.ima.setUpPlayerIntervals_)};d=M({},U,z||{});if(d.id){N=document.getElementById(d.id+
"_html5_api");A=!0;0==d.showCountdown&&(A=!1);x=!0;0==d.autoPlayAdBreaks&&(x=!1);a.one("play",a.ima.setUpPlayerIntervals_);a.on("ended",I);var V=M({},{debug:d.debug,timeout:d.timeout,prerollTimeout:d.prerollTimeout},z.contribAdsSettings||{});a.ads(V);F=new google.ima.AdsRenderingSettings;F.restoreCustomPlaybackStateOnAdBreakComplete=!0;if(d.adsRenderingSettings)for(var T in d.adsRenderingSettings)F[T]=d.adsRenderingSettings[T];d.locale&&google.ima.settings.setLocale(d.locale);a.ima.createAdContainer_();
g=new google.ima.AdsLoader(D);g.getSettings().setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.ENABLED);0==d.vpaidAllowed&&g.getSettings().setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.DISABLED);d.vpaidMode&&g.getSettings().setVpaidMode(d.vpaidMode);d.locale&&g.getSettings().setLocale(d.locale);g.getSettings().setPlayerType("videojs-ima");g.getSettings().setPlayerVersion("0.2.0");g.getSettings().setAutoPlayAdBreaks(x);g.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,
a.ima.onAdsManagerLoaded_,!1);g.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,a.ima.onAdsLoaderError_,!1);q||(q=a.ima.start);a.on("readyforpreroll",q);a.on("fullscreenchange",a.ima.onFullscreenChange_);a.on("volumechange",a.ima.onVolumeChange_)}else window.console.log("Error: must provide id of video.js div")})})(window.videojs);
